LOAD CSV WITH HEADERS FROM "file:///node_table.csv" AS row
MERGE (:Table {name: row.table_name, description: row.table_description});


LOAD CSV WITH HEADERS FROM "file:///node_column.csv" AS row
MERGE (c:Column {name: row.column_name})
SET c.primary_key = (row.primary_key = "TRUE"),
    c.description = row.column_description;

LOAD CSV WITH HEADERS FROM "file:///edge_table_column.csv" AS row
MATCH (t:Table {name: row.table_name})
MATCH (c:Column {name: row.column_name})
MERGE (t)-[:HAS_COLUMN]->(c);

LOAD CSV WITH HEADERS FROM "file:///edge_column_value.csv" AS row
MATCH (c:Column {name: row.column_name})
MERGE (v:Value {name: coalesce(row.value_name, "UNKNOWN")})
MERGE (c)-[:HAS_VALUE]->(v);

LOAD CSV WITH HEADERS FROM "file:///edge_foreign_key.csv" AS row
MATCH (t:Table {name: row.table_name})
MATCH (c:Column {name: row.column_name})
MERGE (c)-[:FOREIGN_KEY_FROM]->(t);
